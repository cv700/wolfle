<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emoji Werewolf Game</title>
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const EmojiWerewolfGame = () => {
            const peopleEmojis = ['üë®', 'üë©', 'üë±', 'üë¥', 'üëµ', 'üë≤', 'üßî', 'üë≥‚Äç‚ôÇÔ∏è', 'üë≥‚Äç‚ôÄÔ∏è', 'üëÆ‚Äç‚ôÇÔ∏è', 'üëÆ‚Äç‚ôÄÔ∏è', 'üë∑‚Äç‚ôÇÔ∏è', 'üë∑‚Äç‚ôÄÔ∏è', 'üíÇ‚Äç‚ôÇÔ∏è', 'üíÇ‚Äç‚ôÄÔ∏è', 'üïµÔ∏è‚Äç‚ôÇÔ∏è', 'üïµÔ∏è‚Äç‚ôÄÔ∏è', 'üë®‚Äç‚öïÔ∏è', 'üë©‚Äç‚öïÔ∏è', 'üë®‚Äçüåæ', 'üë©‚Äçüåæ', 'üë®‚Äçüç≥', 'üë©‚Äçüç≥', 'üë®‚Äçüéì', 'üë©‚Äçüéì', 'üë®‚Äçüè´', 'üë©‚Äçüè´', 'üë®‚Äçüè≠', 'üë©‚Äçüè≠', 'üë®‚Äçüíª', 'üë©‚Äçüíª', 'üë®‚Äçüé§', 'üë©‚Äçüé§', 'üë®‚Äçüé®', 'üë©‚Äçüé®', 'üë®‚Äç‚úàÔ∏è', 'üë©‚Äç‚úàÔ∏è', 'üë®‚ÄçüöÄ', 'üë©‚ÄçüöÄ', 'üë®‚Äçüöí', 'üë©‚Äçüöí'];
            const arrowEmojis = ['‚¨ÜÔ∏è', '‚ÜóÔ∏è', '‚û°Ô∏è', '‚ÜòÔ∏è', '‚¨áÔ∏è', '‚ÜôÔ∏è', '‚¨ÖÔ∏è', '‚ÜñÔ∏è'];
            const gridSize = 7;

            const [gameBoard, setGameBoard] = React.useState([]);
            const [werewolfIndex, setWerewolfIndex] = React.useState(-1);
            const [lastClickedIndex, setLastClickedIndex] = React.useState(-1);
            const [lastClickTime, setLastClickTime] = React.useState(0);
            const [timer, setTimer] = React.useState(0);
            const [isGameOver, setIsGameOver] = React.useState(false);
            const [message, setMessage] = React.useState('');

            React.useEffect(() => {
                initGame();
            }, []);

            React.useEffect(() => {
                if (!isGameOver) {
                    const interval = setInterval(() => {
                        setTimer(prevTimer => prevTimer + 1);
                    }, 1000);
                    return () => clearInterval(interval);
                }
            }, [isGameOver]);

            const initGame = () => {
                const totalTiles = gridSize * gridSize;
                const selectedEmojis = peopleEmojis.sort(() => 0.5 - Math.random()).slice(0, 25);
                const allEmojis = [...selectedEmojis.slice(0, 24), ...selectedEmojis.slice(0, 24)];
                const newWerewolfIndex = Math.floor(Math.random() * totalTiles);
                allEmojis.splice(newWerewolfIndex, 0, selectedEmojis[24]);
                
                setGameBoard(allEmojis.map(emoji => ({ 
                    emoji, 
                    isClicked: false,
                    isMatched: false
                })));
                setWerewolfIndex(newWerewolfIndex);
                setIsGameOver(false);
                setTimer(0);
                setMessage('');
            };

            const handleTileClick = (index) => {
                if (isGameOver || gameBoard[index].isMatched) return;

                const currentTime = new Date().getTime();
                if (currentTime - lastClickTime < 300 && lastClickedIndex === index) {
                    // Double click detected
                    if (index === werewolfIndex) {
                        endGame(true);
                    } else {
                        endGame(false);
                    }
                } else {
                    // Single click
                    setGameBoard(prevBoard => {
                        const newBoard = [...prevBoard];
                        newBoard[index] = {...newBoard[index], isClicked: !newBoard[index].isClicked};
                        return newBoard;
                    });
                    checkMatch(index);
                }
                setLastClickTime(currentTime);
                setLastClickedIndex(index);
            };

            const checkMatch = (index) => {
                const currentEmoji = gameBoard[index].emoji;
                const matchIndex = gameBoard.findIndex((tile, i) => 
                    i !== index && 
                    tile.emoji === currentEmoji && 
                    tile.isClicked && 
                    !tile.isMatched
                );

                if (matchIndex !== -1) {
                    setGameBoard(prevBoard => {
                        const newBoard = [...prevBoard];
                        newBoard[index] = {...newBoard[index], isMatched: true};
                        newBoard[matchIndex] = {...newBoard[matchIndex], isMatched: true};
                        return newBoard;
                    });
                }
            };

            const getArrowEmoji = (fromIndex, toIndex) => {
                const fromRow = Math.floor(fromIndex / gridSize);
                const fromCol = fromIndex % gridSize;
                const toRow = Math.floor(toIndex / gridSize);
                const toCol = toIndex % gridSize;
                
                const deltaY = toRow - fromRow;
                const deltaX = toCol - fromCol;
                
                if (deltaY < 0) {
                    if (deltaX < 0) return '‚ÜñÔ∏è';
                    if (deltaX === 0) return '‚¨ÜÔ∏è';
                    return '‚ÜóÔ∏è';
                }
                if (deltaY === 0) {
                    if (deltaX < 0) return '‚¨ÖÔ∏è';
                    if (deltaX > 0) return '‚û°Ô∏è';
                }
                if (deltaY > 0) {
                    if (deltaX < 0) return '‚ÜôÔ∏è';
                    if (deltaX === 0) return '‚¨áÔ∏è';
                    return '‚ÜòÔ∏è';
                }
                return ''; // This should never happen
            };

            const endGame = (isWin) => {
                setIsGameOver(true);
                setMessage(isWin ? "You found the werewolf! You win!" : "Wrong guess! Game over.");
                setGameBoard(prevBoard => {
                    const newBoard = [...prevBoard];
                    newBoard[werewolfIndex] = {...newBoard[werewolfIndex], emoji: 'üê∫'};
                    return newBoard;
                });
            };

            return (
                <div className="game-container" style={{fontFamily: 'Arial, sans-serif', textAlign: 'center', maxWidth: '600px', margin: '0 auto', padding: '20px'}}>
                    <h1>Emoji Werewolf Game</h1>
                    <div style={{height: '20px', marginTop: '10px', fontSize: '18px', fontWeight: 'bold'}}>
                        Time: {Math.floor(timer / 60)}:{(timer % 60).toString().padStart(2, '0')}
                    </div>
                    <div className="game-board" style={{display: 'inline-grid', gap: '5px', margin: '20px 0', gridTemplateColumns: `repeat(${gridSize}, 1fr)`}}>
                        {gameBoard.map((tile, index) => (
                            <div 
                                key={index} 
                                className={`tile ${tile.isClicked ? 'clicked' : ''}`}
                                style={{
                                    width: '60px', 
                                    height: '60px', 
                                    fontSize: '30px', 
                                    backgroundColor: tile.isClicked ? '#e0e0e0' : '#fff', 
                                    border: '1px solid #ccc',
                                    display: 'flex',
                                    justifyContent: 'center',
                                    alignItems: 'center',
                                    cursor: 'pointer',
                                    transition: 'transform 0.3s'
                                }}
                                onClick={() => handleTileClick(index)}
                            >
                                {tile.isMatched ? getArrowEmoji(index, werewolfIndex) : tile.emoji}
                            </div>
                        ))}
                    </div>
                    <div style={{height: '20px', marginTop: '10px', fontSize: '18px', fontWeight: 'bold'}}>
                        {message}
                    </div>
                    <button onClick={initGame} style={{marginTop: '10px', padding: '5px 10px', fontSize: '16px'}}>New Game</button>
                </div>
            );
        };

        ReactDOM.render(<EmojiWerewolfGame />, document.getElementById('root'));
    </script>
</body>
</html>
